pub struct APUMixer {
  pub pulse_1_out: u8,
  pub pulse_2_out: u8,
}

const PULSE_OUT_LOOKUP: [f32; 31] = [
  0.0,
  0.011609139523578026,
  0.022939481268011527,
  0.03400094921689606,
  0.04480300187617261,
  0.05535465924895688,
  0.06566452795600367,
  0.07574082464884459,
  0.08559139784946236,
  0.09522374833850243,
  0.10464504820333041,
  0.11386215864759427,
  0.12288164665523155,
  0.13170980059397538,
  0.14035264483627205,
  0.1488159534690486,
  0.15710526315789472,
  0.16522588522588522,
  0.1731829170024174,
  0.18098125249301955,
  0.18862559241706162,
  0.19612045365662886,
  0.20347017815646784,
  0.21067894131185272,
  0.21775075987841944,
  0.2246894994354535,
  0.2314988814317673,
  0.23818248984115256,
  0.2447437774524158,
  0.2511860718171926,
  0.25751258087706685,
];

impl APUMixer {
  pub fn new() -> Self {
    APUMixer {
      pulse_1_out: 0,
      pulse_2_out: 0,
    }
  }

  pub fn get_output(&self) -> f32 {
    PULSE_OUT_LOOKUP[(self.pulse_1_out + self.pulse_2_out) as usize]
  }
}
